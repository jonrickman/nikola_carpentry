{% extends 'base.html' %}

<!-- Head -->
{% block head %}
<title>Reviews</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/reviews.css') }}" type="text/css" />
{% endblock %}
<!--Body-->
{% block body %}


{% for message in get_flashed_messages() %}
<h2>{{ message }}</h2>
{% endfor %}

<div class="bg-image">
  <div id="header" class="d-flex text-center bg-primary text-white py-5">
    <div class="container">
      <h1 class="display-4">Reviews</h1>
    </div>
  </div>

  <!-- admin section -->
  {% if user.username %}

  {% if unapproved_reviews %}
  <div class="container-fluid">
    <span id="review-count">
      {{ unapproved_reviews|length }} Unapproved Customer Reviews
    </span>

    {% for review in unapproved_reviews %}
    {% include 'review.html' %}
    {% endfor %}
    <!-- no new reviews -->
    {% else %}
    <span id="review-count">
      No New Unapproved Customer Reviews
    </span>
    <!-- end unapproved review section -->
    {% endif %}
    <!-- end admin panel section -->
    {% endif %}

    {% if approved_reviews %}
    <div class="container-fluid">
      <span id="review-count">
        {{ approved_reviews|length }} Reviews <br />
        Average: {{ average_rating }}
      </span>

      {% for review in approved_reviews %}
      {% include 'review.html' %}
      {% endfor %}

    </div>
    {% else %}
    {% include 'review-create.html' %}
    {% endif %}

    {% endblock %}
  </div>
</div>