{% extends 'base.html' %}

<!-- Head -->
{% block head %}
<title>Reviews</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/reviews.css') }}" type="text/css" />
{% endblock %}
<!--Body-->
{% block body %}


{% for message in get_flashed_messages() %}
<h2>{{ message }}</h2>
{% endfor %}

<!-- admin section -->
{% if user.username %}
<h1>Review Admin Panel: Welcome {{user.username}}</h1>

{% if unapproved_reviews %}
<div class="container-fluid">
  <span id="review-count">
    {{ unapproved_reviews|length }} Unapproved Customer Reviews
  </span>

  {% for review in unapproved_reviews %}
  {% include 'review.html' %}
  {% endfor %}
  <!-- no new reviews -->
  {% else %}
  <span id="review-count">
    No New Unapproved Customer Reviews
  </span>
  <!-- end unapproved review section -->
  {% endif %}
  <!-- end admin panel section -->
  {% endif %}

  {% if approved_reviews %}
  <div class="container-fluid">
    <span id="review-count">
      {{ approved_reviews|length }} Reviews <br />
      Average: {{ average_rating }}
    </span>

    {% for review in approved_reviews %}
    {% include 'review.html' %}
    {% endfor %}

  </div>
  {% endif %}

  <div class="container-fluid new-review">
    <span id="add-review">Add a review</span>
    <form method="POST">
      {{ form.hidden_tag()}}

      <div class="row">
        {{ form.author.label }}
        {{ form.author }}
      </div>


      <div class="row">
        {{ form.rating.label }}
        {{ form.rating(class="form-control") }}
      </div>


      <div class="row">
        {{ form.title.label }}
        {{ form.title }}
      </div>

      {{ form.content() }}
      {{ ckeditor.load() }}
      {{ ckeditor.config(name='content') }}

      <div class="row">
        <input type="file">Select Files
      </div>

      <div class="row">
        {{ form.submit(class="btn btn-primary col-sm-5")}}
      </div>
    </form>
  </div>
  {% endblock %}