{% extends 'base.html' %}

<!-- Head -->
{% block head %}
<title>Projects</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/projects.css') }}" type="text/css" />
{% endblock %}
<!--Body-->
{% block body %}

{% for message in get_flashed_messages() %}
<h2>{{ message }}</h2>
{% endfor %}

<div class="container">

  <div class="mt-4 p-5 bg-primary text-white rounded">
    <h1>Custom Projects</h1>
  </div>

  {% if ready_projects %}
  <div id="project-pane" class="container-fluid">

    {% for project in ready_projects %}
    <div class="project">
      <span class="project-title">{{ project.title }}</span>
      <br />

      <span class="project-date">{{ project.pretty_date() }}</span>
      <br />

      <div class="project-content">
        {{ project.content|safe }}
      </div>
      <br />
      <div class="project-files">

        {% for project_file in project.get_files() %}
        <div class="grid-item">
          <img src="{{ url_for('static', filename=project_file) }}" />
        </div>
        {% endfor %}
      </div>
      <br />
      </form>
    </div>

    {% endfor %}
    <!-- end of project-pane -->
    {% endif %}

    {% if user.username %}
    <div class="container-fluid project">
      <span id="add-project">Add a project</span>
      <form method="POST" enctype="multipart/form-data">
        {{ form.hidden_tag()}}

        <div class="row">
          {{ form.title.label(class="project-title-label") }}
          {{ form.title(class="project-title") }}
        </div>

        <div class="project-content">
          {{ form.content.label}}
          {{ form.content() }}
          {{ ckeditor.load() }}
          {{ ckeditor.config(name='content') }}
        </div>

        <div class="row">
          {{ form.files }}
        </div>

        <!-- TODO: this needs cleanup -->
        <div class="scroll-container">
          <div class="grid-container">
            {% for project_file in project_files %}
            <div class="grid-item scroll-content">
              <img src="{{ url_for('static', filename=project_file) }}" alt="{{ project_file.name }}">
              <div class="overlay">
                <input type="checkbox" name="selected_images" value="{{ project_file.id }}">
              </div>
            </div>
            {% endfor %}
          </div>
        </div>

        <div class="row">
          {{ form.submit(class="btn btn-primary col-sm-5")}}
        </div>

      </form>
      {% endif %}
    </div>
  </div>
</div>

{% endblock %}